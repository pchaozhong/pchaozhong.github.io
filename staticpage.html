<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <script type="text/javascript" src="./web3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js/dist/web3.min.js"></script>
    <script type="text/javascript">
		var WorldCup2018;
		var arrOutcomeName = new Array(4);
		{
			arrOutcomeName[0] = "UNKNOWN";
			arrOutcomeName[1] = "WIN";
			arrOutcomeName[2] = "LOSE";
			arrOutcomeName[3] = "TIE";
		}
		var arrTeamName = new Array(33);
		{
			arrTeamName[0] = "UNKNOWN";
			arrTeamName[1] = "Russia";
			arrTeamName[2] = "SaudiArabia";
			arrTeamName[3] = "Egypt";
			arrTeamName[4] = "Uruguay";
			arrTeamName[5] = "Portugal";
			arrTeamName[6] = "Spain";
			arrTeamName[7] = "Morocco";
			arrTeamName[8] = "Iran";
			arrTeamName[9] = "France";
			arrTeamName[10] = "Australia";
			arrTeamName[11] = "Peru";
			arrTeamName[12] = "Denmark";
			arrTeamName[13] = "Argentina";
			arrTeamName[14] = "Iceland";
			arrTeamName[15] = "Croatia";
			arrTeamName[16] = "Nigeria";
			arrTeamName[17] = "Brazil";
			arrTeamName[18] = "Switzerland";
			arrTeamName[19] = "CostaRica";
			arrTeamName[20] = "Serbia";
			arrTeamName[21] = "Germany";
			arrTeamName[22] = "Mexico";
			arrTeamName[23] = "Sweden";
			arrTeamName[24] = "SouthKorea";
			arrTeamName[25] = "Belgium";
			arrTeamName[26] = "Panama";
			arrTeamName[27] = "Tunisia";
			arrTeamName[28] = "England";
			arrTeamName[29] = "Poland";
			arrTeamName[30] = "Senegal";
			arrTeamName[31] = "Colombia";
			arrTeamName[32] = "Japan";
		}
		window.addEventListener('load', function () {
		if (typeof web3 !== 'undefined') {
			console.log('Web3 Detected! ' + web3.currentProvider.constructor.name)
			window.web3 = new Web3(web3.currentProvider);
		} else {
			console.log('No Web3 Detected... using HTTP Provider')
			window.web3 = new Web3(new Web3.providers.HttpProvider("https://ropsten.infura.io/SockCQRLEtdDj6vi03nt"));
		}

		web3.eth.defaultAccount = '0xe44613033c8c9952A3A5119cDD6B29A471bCEc38';
		const transactionObject = {
			from: web3.eth.accounts[0],
			gas: '4700000'
			gasPrice: '21000'
		};

		var WorldCup2018Contract = web3.eth.contract([
	{
		"constant": true,
		"inputs": [],
		"name": "totalPayments",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_tax",
				"type": "uint8"
			}
		],
		"name": "setClamTax",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "cfoAddress",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "ceoAddress",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_newCEO",
				"type": "address"
			}
		],
		"name": "setCEO",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_matchId",
				"type": "uint8"
			},
			{
				"name": "_prediction",
				"type": "uint8"
			}
		],
		"name": "betMatch",
		"outputs": [],
		"payable": true,
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_newCOO",
				"type": "address"
			}
		],
		"name": "setCOO",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [],
		"name": "unpause",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [],
		"name": "kill",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "",
				"type": "uint256"
			},
			{
				"name": "",
				"type": "uint256"
			}
		],
		"name": "nm_players",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_newCFO",
				"type": "address"
			}
		],
		"name": "setCFO",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "getUserAccountInfo",
		"outputs": [
			{
				"name": "invested",
				"type": "uint256"
			},
			{
				"name": "prize",
				"type": "uint256"
			},
			{
				"name": "balance",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "getMatchInfoList01",
		"outputs": [
			{
				"name": "matchIdArray",
				"type": "uint8[64]"
			},
			{
				"name": "hostTeamIdArray",
				"type": "uint8[64]"
			},
			{
				"name": "guestTeamIdArray",
				"type": "uint8[64]"
			},
			{
				"name": "startTimeArray",
				"type": "uint256[64]"
			},
			{
				"name": "outcomeArray",
				"type": "uint8[64]"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "paused",
		"outputs": [
			{
				"name": "",
				"type": "bool"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [],
		"name": "withdrawPayments",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "totalInvest",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [],
		"name": "renounceOwnership",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_matchId",
				"type": "uint8"
			},
			{
				"name": "_startTime",
				"type": "uint256"
			}
		],
		"name": "updateMatchStartTime",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [],
		"name": "pause",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"name": "accountInfos",
		"outputs": [
			{
				"name": "invested",
				"type": "uint256"
			},
			{
				"name": "prize",
				"type": "uint256"
			},
			{
				"name": "claimed",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "owner",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "",
				"type": "uint8"
			}
		],
		"name": "matchs",
		"outputs": [
			{
				"name": "matchId",
				"type": "uint8"
			},
			{
				"name": "hostTeamId",
				"type": "uint8"
			},
			{
				"name": "guestTeamId",
				"type": "uint8"
			},
			{
				"name": "startTime",
				"type": "uint256"
			},
			{
				"name": "outcome",
				"type": "uint8"
			},
			{
				"name": "totalInvest",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "getMatchInfoList02",
		"outputs": [
			{
				"name": "winPredictionArray",
				"type": "uint256[64]"
			},
			{
				"name": "losePredictionArray",
				"type": "uint256[64]"
			},
			{
				"name": "tiePredictionArray",
				"type": "uint256[64]"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_matchId",
				"type": "uint8"
			},
			{
				"name": "_hostTeamId",
				"type": "uint8"
			},
			{
				"name": "_guestTeamId",
				"type": "uint8"
			}
		],
		"name": "updateMatch",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_matchId",
				"type": "uint8"
			},
			{
				"name": "_outcome",
				"type": "uint8"
			}
		],
		"name": "setOutcome",
		"outputs": [
			{
				"name": "",
				"type": "bool"
			}
		],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "pageInfoEmit",
		"outputs": [],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "cooAddress",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"name": "match_pools",
		"outputs": [
			{
				"name": "",
				"type": "uint8"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"name": "payments",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "newOwner",
				"type": "address"
			}
		],
		"name": "transferOwnership",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "CLAIM_TAX",
		"outputs": [
			{
				"name": "",
				"type": "uint8"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "getMatchInfoList03",
		"outputs": [
			{
				"name": "winPredictionArrayForLoginUser",
				"type": "uint256[64]"
			},
			{
				"name": "losePredictionArrayForLoginUser",
				"type": "uint256[64]"
			},
			{
				"name": "tiePredictionArrayForLoginUser",
				"type": "uint256[64]"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"payable": true,
		"stateMutability": "payable",
		"type": "fallback"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"name": "_matchIdArray",
				"type": "uint8[64]"
			},
			{
				"indexed": false,
				"name": "_hostTeamIdArray",
				"type": "uint8[64]"
			},
			{
				"indexed": false,
				"name": "_guestTeamIdArray",
				"type": "uint8[64]"
			},
			{
				"indexed": false,
				"name": "_startTimeArray",
				"type": "uint256[64]"
			},
			{
				"indexed": false,
				"name": "_outcomeArray",
				"type": "uint8[64]"
			}
		],
		"name": "MatchInfoList01",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"name": "_winPredictionArray",
				"type": "uint256[64]"
			},
			{
				"indexed": false,
				"name": "_losePredictionArray",
				"type": "uint256[64]"
			},
			{
				"indexed": false,
				"name": "_tiePredictionArray",
				"type": "uint256[64]"
			}
		],
		"name": "MatchInfoList02",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"name": "_winPredictionArrayForLoginUser",
				"type": "uint256[64]"
			},
			{
				"indexed": false,
				"name": "_losePredictionArrayForLoginUser",
				"type": "uint256[64]"
			},
			{
				"indexed": false,
				"name": "_tiePredictionArrayForLoginUser",
				"type": "uint256[64]"
			}
		],
		"name": "MatchInfoList03",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"name": "_invested",
				"type": "uint256"
			},
			{
				"indexed": false,
				"name": "_prize",
				"type": "uint256"
			},
			{
				"indexed": false,
				"name": "_balance",
				"type": "uint256"
			}
		],
		"name": "UserAccountInfo",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"name": "newContract",
				"type": "address"
			}
		],
		"name": "ContractUpgrade",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"name": "previousOwner",
				"type": "address"
			}
		],
		"name": "OwnershipRenounced",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"name": "previousOwner",
				"type": "address"
			},
			{
				"indexed": true,
				"name": "newOwner",
				"type": "address"
			}
		],
		"name": "OwnershipTransferred",
		"type": "event"
	}
]);
		// https://ropsten.etherscan.io/tx/0x8ab6951312c1d59e42a1f47b725fe72da6eada1a3c9efed31ebff63a770c651a
		WorldCup2018 = WorldCup2018Contract.at('0xce35e70f8c1b23bee9b8b3221bb303fd49673d2a');
		console.log(WorldCup2018);
		})

		function getBalance() {
			var address, wei, balance
			address = document.getElementById("address").value
			try {
				web3.eth.getBalance(address, function (error, wei) {
					if (!error) {
						var balance = web3.fromWei(wei, 'ether');
						document.getElementById("output").innerHTML = balance + " ETH";
					}
				});
			} catch (err) {
				document.getElementById("output").innerHTML = err;
			}
		}

		function getUserAccountInfo() {
			try {
				WorldCup2018.getUserAccountInfo(function(error, result){
					if(!error) {
						document.getElementById("userAccountInfo").innerHTML = "invested : " + result[0] + " , prize : " + result[1] + " , balance : " + result[2] + " .";
						console.log(result);
					} else
						console.error(error);
				});
			} catch (err) {
				document.getElementById("userAccountInfo").innerHTML = err;
			}
		}

		function getMatchInfoList01() {
			try {
				WorldCup2018.getMatchInfoList01(function(error, result){
					if(!error) {
						console.log(result);
						// matchInfo_title
						var table = document.getElementById("matchInfoList");
						for (var intI = 0; intI < 64; intI++) {
							var gmtDate  = new Date('1970-01-01 00:00:00+00:00');
							// Match start at gmtDate([GMT Start Date] + [diffSeconds from contract])
							gmtDate.setSeconds(gmtDate.getSeconds() + result[3][intI]);

							var row = table.insertRow(table.rows.length);
							// Match No.
							{
								var cellMatchNo = row.insertCell(0);
								var tMatchNo = document.createElement("span");
								tMatchNo.id = "matchNo_" + (intI + 1);
								tMatchNo.innerHTML = result[0][intI];
								cellMatchNo.appendChild(tMatchNo);
							}
							// HostTeamName
							{
								var cellHostTeamName = row.insertCell(1);
								var tHostTeamName = document.createElement("span");
								tHostTeamName.id = "hostTeamName_" + (intI + 1);
								tHostTeamName.innerHTML = arrTeamName[result[1][intI]];
								cellHostTeamName.appendChild(tHostTeamName);
							}
							// GuestTeamName
							{
								var cellGuestTeamName = row.insertCell(2);
								var tGuestTeamName = document.createElement("span");
								tGuestTeamName.id = "guestTeamName_" + (intI + 1);
								tGuestTeamName.innerHTML = arrTeamName[result[2][intI]];
								cellGuestTeamName.appendChild(tGuestTeamName);
							}
							// StartTime(GMT/LOCAL)
							{
								var cellStartTime = row.insertCell(3);
								var tStartTimeGmt = document.createElement("span");
								tStartTimeGmt.id = "startTimeGmt_" + (intI + 1);
								tStartTimeGmt.innerHTML = gmtDate.toGMTString();
								cellStartTime.appendChild(tStartTimeGmt);

								var tStartTime = document.createElement("br");
								cellStartTime.appendChild(tStartTime);

								var tStartTimeLocal = document.createElement("span");
								tStartTimeLocal.id = "startTimeLocal_" + (intI + 1);
								tStartTimeLocal.innerHTML = gmtDate.toLocaleString();
								cellStartTime.appendChild(tStartTimeLocal);
							}
							// Result
							{
								var cellResult = row.insertCell(4);
								var tResult = document.createElement("span");
								tResult.id = "result_" + (intI + 1);
								tResult.innerHTML = arrOutcomeName[result[4][intI]];
								cellResult.appendChild(tResult);
							}
						}
					} else
						console.error(error);
				});
			} catch (err) {
				document.getElementById("matchInfo_title").innerHTML = err;
			}
		}

		function doPrediction() {
			try {
				// uint8 _matchId, uint8 _prediction
				value matchId = document.getElementById("inputMatchNo").value;
				value prediction = document.getElementById("inputPrediction").value;
				value investValue = document.getElementById("inputInvest").value;
				WorldCup2018.betMatch(matchId, prediction, {from: web3.eth.accounts[0], gas: '4700000', gasPrice: '21000', value: web3.toWei(investValue, 'ether')}, function(error){
					if(!error) {
						document.getElementById("doPredictionInfo").innerHTML = "Prediction should be recorded in the next block of [Ethereum Block Chain] as soon.";
						// console.log(result);
					} else
						console.error(error);
				});
			} catch (err) {
				document.getElementById("doPredictionInfo").innerHTML = err;
			}
		}
	</script>
</head>
<body>
	<h1>ETH Balance Fetcher</h1>
	<p>Enter your Ethereum Address:</p>
	<input type="text" size="50" id="address" />
	<button type="button" onClick="getBalance();">Get Balance</button>
	<br />
	<br />
	<div id="output"></div>
	<br />
	<br />
	<button type="button" onClick="getUserAccountInfo();">Get User Account Info</button>
	<br />
	<div id="userAccountInfo"></div>
	<br />
	<h1>Match Prediction Of World Cup 2018</h1>
	<p>Enter your Prediction :</p>
	<p>Match No.<br>
		<input type="text" size="5" maxlength="2" id="inputMatchNo" />
	</p>
	<p>Prediction<br>
		<input type="radio" name="inputPrediction" value="1"> WIN
		<input type="radio" name="inputPrediction" value="2"> LOSE
		<input type="radio" name="inputPrediction" value="3"> TIE
	</p>
	<p>Invest<br>
		<input type="text" size="50" id="inputInvest" /><span>&nbsp ETH</span>
		<br />
		<span>Attention : Please input your Invest between 0.01 and 100.(***Amount in ETH***)</span>
	</p>
	<button type="button" onClick="doPrediction();">Make your Prediction</button>
	<br />
	<div id="doPredictionInfo"></div>
	<br />
	<br />
	<button type="button" onClick="getMatchInfoList01();">Get Match Info</button>
	<br />
	<table id="matchInfoList_hd" border="1" cellpadding="0" cellspacing="0" style="height: 30px; width: 1000px;">
		<th style="width:150px">Match No.</th>
		<th style="width:175px">HostTeamName</th>
		<th style="width:175px">GuestTeamName</th>
		<th style="width:400px">StartTime(GMT/LOCAL)</th>
		<th style="width:100px">Result</th>
	</table>
	<div align="left" id="matchInfo_title" style="height: 288px; width: 1018px; overflow: auto; overflow-y: auto; overflow-x: hidden;">
		<table id="matchInfoList" border="1" cellpadding="0" cellspacing="0" style="width: 1000px;">
			<tr height="24">
				<td style="width:150px"><span>Ex : Match No.</span></td>
				<td style="width:175px"><span>Ex : HostTeamName</span></td>
				<td style="width:175px"><span>Ex : GuestTeamName</span></td>
				<td style="width:400px"><span>Ex : StartTime(GMT / LOCAL)</span></td>
				<td style="width:100px"><span>Ex : Result</span></td>
			</tr>
		</table>
	</div>
	<br />
</body>
</html>
